%

O430 if [#1999 EQ 1]

#4419 = 0

m91p5(AP-SetFirstTemp)
m91p5(AP-GETCOUNT)

O413 if [#2000 EQ 1]
        m90p1
O413 else
        m90p2
O413 endif



#2008 = 0

O415 if [#4100 EQ -1]
   (debug,单片模式 #2011 )
   #2008 = #2011
   #1=0
   O419 while [#1 LT #2007]
     #[2104+#1*5]=1
     #1=[#1+1]
   O419 endwhile
O415 endif

M9
g4p0.3

m64p6
g0 g53 z0x[#2013]y[#2014]
(debug,总共 #2007 片)

O113 while [#2008 LT #2007]

  #2004 = 0
  m91p5(AP-ARRAY#2008)
  #2010=0


  O111 repeat [#2005]
    m91p5(AP-L#2004)


    O110 if[#4100 EQ 0]
    g0g53x[#2000]y[#2001]
    g0g53z[#2002]
    m91p5(AP-GetDelayTime)
    g4p[#2006]
    O110 else
      /(debug,扫描到第 #2004 个点,继续运行)
    O110 endif


    m91p3600(AP-I#2004)

    O110 if[#4100 EQ -1]
       /(debug,第 #2004 个点失败)
       #2010=1
       m65p5
       m30
    O110 endif

    O110 if[#4100 EQ -2]
        /(debug,第 #2004 个点失败,继续运行)
        #2010=1
    O110 endif


  #2004 = [#2004 +1]
  O111 endrepeat

  m91p5(AP-Calculate)
  O112 if[#4100 EQ -1]
     (debug,识别异常)
     m65p5
     m30
  O112 endif


  #[2100+#2008*5]=#2000
  #[2101+#2008*5]=#2001
  #[2103+#2008*5]=#2003


  O119 if[#2010 EQ 0]
    #2012 = [#2008 + 1]
    (debug,片数：#2012 X：#2000 Y：#2001 R：#2003)
    #[2104+#2008*5]=0

  O119 else

    #[2104+#2008*5]=1
    O129 if [#4077*#4078 EQ 0]
      #2012 = [#2008 + 1]
      (debug,片数：#2012 识别失败！！)
    O129 else
      (debug,扫描到第#2008片)
    O129 endif

  O119 endif


  O412 if [#4100 EQ -2]
   #2008=#2007
  O412 endif


#2008 = [#2008+1]
O113 endwhile



O003 if [#2007 EQ 1]
  O123 if [#4410 EQ 1]
      g10 l2 p[#5220] x[#2000] y[#2001] Z[#4413]
  O123 else
      g10 l2 p[#5220] x[#2000] y[#2001]
  O123 endif
  g68r[#2003]
  (debug,工序1拍照信息： X：#2000 Y：#2001 R：#2003)
	#4411 = #2000
	#4412 = #2001
	#4414 = #2003

O003 endif


O630 if [#4410 EQ 1]

m91p5(AP-SetSecondTemp)
m91p5(AP-GETCOUNT)

#2008 = 0

O515 if [#4100 EQ -1]
   (debug,单片模式 #2011 )
   #2008 = #2011
   #1=0
   O519 while [#1 LT #2007]
     #[2104+#1*5]=1
     #1=[#1+1]
   O519 endwhile
O515 endif


g0 g53 z0x[#2013]y[#2014]
(debug,总共 #2007 片)

O513 while [#2008 LT #2007]

  #2004 = 0
  m91p5(AP-ARRAY#2008)
  #2010=0


  O511 repeat [#2005]
    m91p5(AP-L#2004)


    O510 if[#4100 EQ 0]
    g0g53x[#2000]y[#2001]
    g0g53z[#2002]
    m91p5(AP-GetDelayTime)
    g4p[#2006]
    O510 else
      /(debug,扫描到第 #2004 个点,继续运行)
    O510 endif


    m91p3600(AP-I#2004)

    O510 if[#4100 EQ -1]
       /(debug,第 #2004 个点失败)
       #2010=1
       m65p5
       m30
    O510 endif

    O510 if[#4100 EQ -2]
        /(debug,第 #2004 个点失败,继续运行)
        #2010=1
    O510 endif


  #2004 = [#2004 +1]
  O511 endrepeat

  m91p5(AP-Calculate)
  O512 if[#4100 EQ -1]
     (debug,识别异常)
     m65p5
     m30
  O512 endif


  #[2100+#2008*5]=#2000
  #[2101+#2008*5]=#2001
  #[2103+#2008*5]=#2003


  O519 if[#2010 EQ 0]
    #2012 = [#2008 + 1]
    (debug,片数：#2012 X：#2000 Y：#2001 R：#2003)
    #[2104+#2008*5]=0

  O519 else

    #[2104+#2008*5]=1
    O529 if [#4077*#4078 EQ 0]
      #2012 = [#2008 + 1]
      (debug,片数：#2012 识别失败！！)
    O529 else
      (debug,扫描到第#2008片)
    O529 endif

  O519 endif


  O512 if [#4100 EQ -2]
   #2008=#2007
  O512 endif


#2008 = [#2008+1]
O513 endwhile


O503 if [#2007 EQ 1]

  /g10 l2 p[#5220] x[#2000] y[#2001]
  /g68r[#2003]
  (debug,工序2拍照信息： X：#2000 Y：#2001 R：#2003)
	#4415 = #2000
	#4416 = #2001
	#4418 = #2003
	#4419 = 1
O503 endif

O630 endif


m65p6

O430 endif

%

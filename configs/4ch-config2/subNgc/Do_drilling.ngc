
  



O131 sub


    #3610=0.5
	
	#<current_num>=#4085

    #<z1_start>=[#3760+[[#3657-#3689]-#3990]]
    #<z2_start>=[#3761+[[#3657-#3689]-#3990]]

	#<fast_feed>=#3612

    G1.1(N11_#<z1_start> N14_#<z2_start>)F#<fast_feed>
	

    (###############################上料####################################)
	
	M72P11
	M71P7(打开定位气缸)
	M71P10(传送带高速)
	M71P8(传送带正转)

	M70P22L1
	
	m66p0l4q#3611(检测木板感应信号)
	O002 if[#5399 EQ -1]
	
	    O003 if[#3680 EQ 2]
	    (debug,The board was not detected in #3611 seconds and out of operation)
	    O003 else 
	    (debug,超过#3611 秒没有检测到木板，退出运行)
	    O003 endif
	
	
	    #3941=1
	    M70P22L0
	    M72P8
	    M72P7
	    M30

	O002 endif
	
	/M72P10
	/M71P11(传送带低速)
	
	g4p#3605(送料到位延时)
	
	M72P8
	M72P11(关闭传送带)
	m71p6(顶板)

    g4p0.1
    m71p2(前推1)
    O003 if[#3940 GT 0]
    m71p3(前推2)
    O003 endif
    g4p#3606(前推时间)


    m71p15(侧推4)
    O005 if[#3960 GT #3956]
    m71p14(侧推3)
    O005 endif 
    O005 if[#3960 GT #3955]
    m71p13(侧推2)
    O005 endif 
    O005 if[#3960 GT #3954]
    m71p12(侧推1)
    O005 endif 
    g4p#3607(侧推时间)






O131 endsub



/(debug,单机连线模式)

O134 if[#3684 GT 0]

	#3684 = 0

	O131 call

O134 else

	#3684 = 1

	M71P8(传送带正转)
	M71P10(传送带高速)

	m66p0l4q3600(检测木板感应信号)
	O002 if[#5399 EQ -1]

		O003 if[#3680 EQ 1]
		(debug,超过3600 秒没有检测到木板，退出运行)
		O003 else if[#3680 EQ 2]
		(debug,The board was not detected in 3600 seconds and out of operation)
		O003 endif


        #3941=1
		M72P8
		M72P7
		M30
	O002 endif



	m66p0l3q5(检测木板感应信号)
    g4p#3608(定位下降长板)

O134 endif










	

M74P0

(回退板面安全高度)
G1.1(N11_14.095   N14_22.415   )F5000
(移动到定位)
G1.1(N10_59.956   N12_-463.847   N13_-83.772   N15_-267.231   )F25000
(15 23 24 )
M73P1
G4P[#3601]
M64P0
(运动到板材面-1)
G1.1(N11_28.095   )F5000
(慢速开始钻孔)
G1.1(N11_32.095   )F5000
(目标深度)
G1.1(N11_34.095   )F5000
G4P[#3602]
(回退板面安全高度)
G1.1(N11_14.095   N14_22.415   )F5000
M74P1

G4P[#3604]
M65P0
M65P25

(完成标志)
#4085=[#4085+1]
#3942=1

(移动到定位)
G1.1(N10_59.956   N12_-463.847   N13_-83.772   N15_-267.231   )F25000


    #3610=0.5
(##################################下料########################################)

    m72p2(关前推1)
    m72p3(关前推2)

    M72P7(关闭定位气缸)

    m72p12(侧推1)
    m72p13(侧推2)
    m72p14(侧推3)
    m72p15(侧推4)
    g4p#3607(侧推时间)

    m72p6(顶板)
    g4p#3757(顶板延时)


	(###########退料###########)



    #2003=0

	m66p0l0q0(检测木板感应信号)
    O002 if[#5399 EQ 1]
        #2003=1
    O002 else if[#5399 EQ 0]
        #2003=0
    O002 endif

	M71P8(传送带正转)
	M71P10(传送带高速)

    O001 if[#2003 EQ 0]

        m66p0l3q10(检测木板感应信号)
        O002 if[#5399 EQ -1]

            O003 if[#3680 EQ 2]
            (debug,It was detected that the board had not been sent out and was out of operation.)
            O003 else
            (debug,检测到木板还没有送出去，退出运行)
            O003 endif
	
	        #3941=1
            M72P8(传送带正转)
            M72P10(传送带高速)
        	#4085=[#4085+1]
            M30

        O002 endif

        g4p#3608(定位下降长板)

    O001 else if[#2003 EQ 1]

        g4p#3610(定位下降短板)

    O001 endif

	#4085=[#4085+1]

    
    /M72P8(传送带正转)






